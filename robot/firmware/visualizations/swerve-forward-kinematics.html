<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Swerve example forward kinematics</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">

    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script>

    <!-- To automatically render math in text elements, include the auto-render extension: -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
    
    <script>
        function applyRotation(type, event) {
            // $(`#${type}`).css("transform", `rotate(${event.target.value}turn)`)
            $(`#${type}-label`).text(Number(event.target.value).toFixed(2))
        }
        function clampAngle(angle) {
            const { floor, abs } = Math
            return angle / floor(abs(angle))
        }
        function calculate() {
            const { floor, abs } = Math
            let a = Number($(`#a-label`).text())
            let b = Number($(`#b-label`).text())
            $(`#a-motor`).text(a.toFixed(2))
            $(`#b-motor`).text(b.toFixed(2))
            
            let lVelocity = (a - b) /2
            let aVelocity = a+b
            $(`#v`).text(lVelocity.toFixed(2))
            $(`#w`).text(aVelocity.toFixed(2))
        } 
    </script>
</head>

<body class="p-3">
    <h1 class="text-xl">Swerve example forward kinematics</h1>
    <div class=" flex flex-row flex-wrap w-full p-10 gap-5 ">
        <div id="knob" class="w-60 h-60 rounded-full relative z-0 border-solid border-2 border-black">
            <div id="absolute" class="w-full h-full absolute -z-1">
                <div class="w-0.5 h-4 bg-black mx-auto relative -top-2"></div>
            </div>

            <div id="current-motors" class="flex flex-row absolute w-full h-1/2 top-1/4">
                <div id="a-motor" class="w-1/2 aspect-square border-solid border-2 border-black rounded-full bg-orange-500 text-center">0.00</div>
                <div id="b-motor" class="w-1/2 aspect-square border-solid border-2 border-black rounded-full bg-blue-500 text-center">0.00</div>
            </div>
        </div>
        <div oninput="calculate()" onchange="calculate()">
            <h3>motor speeds</h3>
            <div class="flex flex-row space-x-2 items-center">
                <label for="a-range" class="block mb-2 text-sm font-medium text-gray-900 w-14">
                    a: <span id="a-label" class="text-orange-500">0.00</span>
                </label>
                <span>-1</span>
                <input id="a-range" type="range" value="0" min="-1" max="1" step="0.01"
                    class=" w-40 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                    oninput="applyRotation('a', event)" />
                <span>1</span>
            </div>
            <div class="flex flex-row space-x-2 items-center">
                <label for="b-range" class="block mb-2 text-sm font-medium text-gray-900 w-14">
                    b: <span id="b-label" class="text-blue-500">0.00</span></label>
                <span>-1</span>
                <input id="b-range" type="range" value="0" min="-1" max="1" step="0.01"
                    class=" w-40 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                    oninput="applyRotation('b', event)" />
                <span>1</span>
            </div>
            <p>1 full power clockwise, -1 full power counter-clockwise</p>
        </div>
        <div class="ring-2 ring-offset-2 rounded-lg p-2 space-y-2 w-80">
            <h3 class="text-lg">results:</h3>
            <div class="ring-2 ring-offset-1 rounded-lg p-1">
                <p>angular velocity: w(t) = <span id="w" class="font-bold">0</span> turn/t</p>
                <p>linear velodity: v(t) = <span id="v" class="font-bold">0</span> turn/t</p>
            </div>
            <p>! The linear velocity goes from -1 to 1 turns but <span class="font-bold">it's torque is doubled</span>, whereas angular velocity's speed can be be twice as fast but with a single motor's worth of torque</p>
        </div>
        <div>
            <h3>Explanations</h3>
            <p>Wa + wb = Ws</p>
            <p>Wa - wb = Vs/2</p>
        </div>
    </div>
</body>

</html>